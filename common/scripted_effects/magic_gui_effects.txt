effect_open_magic_window = {
	scope:actor = {
		set_variable = {
			name = repeat_spell
			value = 1
		}
		set_variable = {
			name = spell_target
			value = scope:recipient
		}
		set_variable = {
			name = list_option
			value = flag:none
		}
		set_variable = {
			name = army_stacks
			value = mage_level
		}
		set_post_spell_actor = yes
		effect_get_all_possible_candidates = yes
		effect_get_all_rewrite_beauty_traits = yes
		effect_get_all_rewrite_physique_traits = yes
		effect_get_all_rewrite_intellect_traits = yes
		effect_get_all_sculpt_flesh_traits = yes
		effect_get_all_sculpt_mind_traits = yes
		effect_get_all_fertility_control_options = yes
		set_variable = {
			name = window_magic_view
			value = 1
		}
	}
}

effect_close_magic_window = {
	remove_variable = window_magic_view
	remove_variable = repeat_spell
	remove_variable = spell_target
	remove_variable = army_stacks
	unset_post_spell_actor = yes
	clear_variable_list = spell_candidates
	clear_variable_list = rewrite_beauty_spell_list
	clear_variable_list = rewrite_physique_spell_list
	clear_variable_list = rewrite_intellect_spell_list
	clear_variable_list = sculpter_of_flesh_spell_list
	clear_variable_list = sculpt_mind_spell_list
	clear_variable_list = fertility_control_spell_list
	if = {
		limit = { has_variable_list = selected_list_options }
		clear_variable_list = selected_list_options
	}
}

effect_get_all_possible_candidates = {
	add_to_variable_list = {
		name = spell_candidates
		target = scope:actor
	}
	every_independent_ruler = {
		limit = { in_diplomatic_range = scope:actor character_is_realm_neighbor = scope:actor }
		save_scope_as = add_ruler
		scope:actor = {
			add_to_variable_list = {
				name = spell_candidates
				target = scope:add_ruler
			}
		}
	}
	if = {
		limit = { is_independent_ruler = no }
		liege = {
			every_vassal = {
				limit = { NOT = { this = scope:actor } }
				save_scope_as = add_vassal
				scope:actor = {
					add_to_variable_list = {
						name = spell_candidates
						target = scope:add_vassal
					}
				}
			}
		}
	}
	every_vassal = {
		save_scope_as = add_vassal
		scope:actor = {
			add_to_variable_list = {
				name = spell_candidates
				target = scope:add_vassal
			}
		}
	}
	every_courtier = {
		save_scope_as = add_courtier
		scope:actor = {
			add_to_variable_list = {
				name = spell_candidates
				target = scope:add_courtier
			}
		}
	}
	if = {
		limit = { scope:actor = { has_variable = slowness_target } }
		add_to_variable_list = {
			name = spell_candidates
			target = scope:actor.var:slowness_target
		}
	}
	if = {
		limit = { scope:actor = { has_variable = mass_slowness_target } }
		add_to_variable_list = {
			name = spell_candidates
			target = scope:actor.var:mass_slowness_target
		}
	}
}

display_aura_times = {
	custom_description_no_bullet = {
		text = display_aura_times_loc
		value = $VALUE$
	}
}

effect_get_all_rewrite_beauty_traits = {
	if = {
		limit = { is_itpp_installed_trigger = yes }
		add_to_variable_list = {
			name = rewrite_beauty_spell_list
			target = flag:beauty_good_5
		}
		add_to_variable_list = {
			name = rewrite_beauty_spell_list
			target = flag:beauty_good_4
		}
	}
	add_to_variable_list = {
		name = rewrite_beauty_spell_list
		target = flag:beauty_good_3
	}
	add_to_variable_list = {
		name = rewrite_beauty_spell_list
		target = flag:beauty_good_2
	}
	add_to_variable_list = {
		name = rewrite_beauty_spell_list
		target = flag:beauty_good_1
	}
	add_to_variable_list = {
		name = rewrite_beauty_spell_list
		target = flag:beauty_none
	}
	add_to_variable_list = {
		name = rewrite_beauty_spell_list
		target = flag:beauty_bad_1
	}
	add_to_variable_list = {
		name = rewrite_beauty_spell_list
		target = flag:beauty_bad_2
	}
	add_to_variable_list = {
		name = rewrite_beauty_spell_list
		target = flag:beauty_bad_3
	}
	if = {
		limit = { is_itpp_installed_trigger = yes }
		add_to_variable_list = {
			name = rewrite_beauty_spell_list
			target = flag:beauty_bad_4
		}
		add_to_variable_list = {
			name = rewrite_beauty_spell_list
			target = flag:beauty_bad_5
		}
	}
}

effect_get_all_rewrite_physique_traits = {
	if = {
		limit = { is_itpp_installed_trigger = yes }
		add_to_variable_list = {
			name = rewrite_physique_spell_list
			target = flag:physique_good_5
		}
		add_to_variable_list = {
			name = rewrite_physique_spell_list
			target = flag:physique_good_4
		}
	}
	add_to_variable_list = {
		name = rewrite_physique_spell_list
		target = flag:physique_good_3
	}
	add_to_variable_list = {
		name = rewrite_physique_spell_list
		target = flag:physique_good_2
	}
	add_to_variable_list = {
		name = rewrite_physique_spell_list
		target = flag:physique_good_1
	}
	add_to_variable_list = {
		name = rewrite_physique_spell_list
		target = flag:physique_none
	}
	add_to_variable_list = {
		name = rewrite_physique_spell_list
		target = flag:physique_bad_1
	}
	add_to_variable_list = {
		name = rewrite_physique_spell_list
		target = flag:physique_bad_2
	}
	add_to_variable_list = {
		name = rewrite_physique_spell_list
		target = flag:physique_bad_3
	}
	if = {
		limit = { is_itpp_installed_trigger = yes }
		add_to_variable_list = {
			name = rewrite_physique_spell_list
			target = flag:physique_bad_4
		}
		add_to_variable_list = {
			name = rewrite_physique_spell_list
			target = flag:physique_bad_5
		}
	}
}

effect_get_all_rewrite_intellect_traits = {
	if = {
		limit = { is_itpp_installed_trigger = yes }
		add_to_variable_list = {
			name = rewrite_intellect_spell_list
			target = flag:intellect_good_5
		}
		add_to_variable_list = {
			name = rewrite_intellect_spell_list
			target = flag:intellect_good_4
		}
	}
	add_to_variable_list = {
		name = rewrite_intellect_spell_list
		target = flag:intellect_good_3
	}
	add_to_variable_list = {
		name = rewrite_intellect_spell_list
		target = flag:intellect_good_2
	}
	add_to_variable_list = {
		name = rewrite_intellect_spell_list
		target = flag:intellect_good_1
	}
	add_to_variable_list = {
		name = rewrite_intellect_spell_list
		target = flag:intellect_none
	}
	add_to_variable_list = {
		name = rewrite_intellect_spell_list
		target = flag:intellect_bad_1
	}
	add_to_variable_list = {
		name = rewrite_intellect_spell_list
		target = flag:intellect_bad_2
	}
	add_to_variable_list = {
		name = rewrite_intellect_spell_list
		target = flag:intellect_bad_3
	}
	if = {
		limit = { is_itpp_installed_trigger = yes }
		add_to_variable_list = {
			name = rewrite_intellect_spell_list
			target = flag:intellect_bad_4
		}
		add_to_variable_list = {
			name = rewrite_intellect_spell_list
			target = flag:intellect_bad_5
		}
	}
}

effect_get_all_sculpt_flesh_traits = {
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:fecund
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:infertile
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:strong
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:weak
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:spindly
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:giant
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:dwarf
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:albino
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:clubfooted
	}
	if = {
		limit = { is_pih_installed_trigger = yes }
		add_to_variable_list = {
			name = sculpter_of_flesh_spell_list
			target = flag:surefooted
		}
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:hunchbacked
	}
	if = {
		limit = { is_pih_installed_trigger = yes }
		add_to_variable_list = {
			name = sculpter_of_flesh_spell_list
			target = flag:regal_bearing
		}
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:lisping
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:scaly
	}
	if = {
		limit = { is_pih_installed_trigger = yes }
		add_to_variable_list = {
			name = sculpter_of_flesh_spell_list
			target = flag:glowing
		}
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:wheezing
	}
	if = {
		limit = { is_pih_installed_trigger = yes }
		add_to_variable_list = {
			name = sculpter_of_flesh_spell_list
			target = flag:hardy_lung
		}
	}
	add_to_variable_list = {
		name = sculpter_of_flesh_spell_list
		target = flag:bleeder
	}
	if = {
		limit = { is_pih_installed_trigger = yes }
		add_to_variable_list = {
			name = sculpter_of_flesh_spell_list
			target = flag:pt_balanced_humors
		}
		add_to_variable_list = {
			name = sculpter_of_flesh_spell_list
			target = flag:nearsighted
		}
		add_to_variable_list = {
			name = sculpter_of_flesh_spell_list
			target = flag:hawkeyed
		}
		add_to_variable_list = {
			name = sculpter_of_flesh_spell_list
			target = flag:deaf
		}
		add_to_variable_list = {
			name = sculpter_of_flesh_spell_list
			target = flag:keen-eared
		}
		add_to_variable_list = {
			name = sculpter_of_flesh_spell_list
			target = flag:permanent_scowl
		}
		add_to_variable_list = {
			name = sculpter_of_flesh_spell_list
			target = flag:friendly_face
		}
	}
}

effect_get_all_sculpt_mind_traits = {
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:lustful
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:chaste
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:gluttonous
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:temperate
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:greedy
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:generous
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:lazy
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:diligent
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:wrathful
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:calm
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:impatient
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:patient
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:arrogant
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:humble
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:deceitful
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:honest
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:craven
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:brave
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:shy
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:gregarious
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:ambitious
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:content
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:arbitrary
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:just
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:cynical
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:zealous
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:paranoid
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:trusting
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:callous
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:sadistic
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:compassionate
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:vengeful
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:forgiving
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:fickle
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:stubborn
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:shrewd
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:dull
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:stuttering
	}
	if = {
		limit = { is_pih_installed_trigger = yes }
		add_to_variable_list = {
			name = sculpt_mind_spell_list
			target = flag:silver_tongued
		}
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:depressed_genetic
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:possessed_genetic
	}
	add_to_variable_list = {
		name = sculpt_mind_spell_list
		target = flag:lunatic_genetic
	}
	if = {
		limit = { is_pih_installed_trigger = yes }
		add_to_variable_list = {
			name = sculpt_mind_spell_list
			target = flag:dyslexic
		}
		add_to_variable_list = {
			name = sculpt_mind_spell_list
			target = flag:hyperlexic
		}
		add_to_variable_list = {
			name = sculpt_mind_spell_list
			target = flag:dyscalculic
		}
		add_to_variable_list = {
			name = sculpt_mind_spell_list
			target = flag:hypercalculic
		}
	}
}

effect_get_all_fertility_control_options = {
	add_to_variable_list = {
		name = fertility_control_spell_list
		target = flag:inc_fertility
	}
	add_to_variable_list = {
		name = fertility_control_spell_list
		target = flag:dec_fertility
	}
}

magic_modify_trait_effect = {
	switch = {
		trigger = $FLAG$
		flag:education_intrigue_1 = { $OPERATION$_trait_force_tooltip = education_intrigue_1 }
		flag:education_intrigue_2 = { $OPERATION$_trait_force_tooltip = education_intrigue_2 }
		flag:education_intrigue_3 = { $OPERATION$_trait_force_tooltip = education_intrigue_3 }
		flag:education_intrigue_4 = { $OPERATION$_trait_force_tooltip = education_intrigue_4 }
		flag:education_diplomacy_1 = { $OPERATION$_trait_force_tooltip = education_diplomacy_1 }
		flag:education_diplomacy_2 = { $OPERATION$_trait_force_tooltip = education_diplomacy_2 }
		flag:education_diplomacy_3 = { $OPERATION$_trait_force_tooltip = education_diplomacy_3 }
		flag:education_diplomacy_4 = { $OPERATION$_trait_force_tooltip = education_diplomacy_4 }
		flag:education_stewardship_1 = { $OPERATION$_trait_force_tooltip = education_stewardship_1 }
		flag:education_stewardship_2 = { $OPERATION$_trait_force_tooltip = education_stewardship_2 }
		flag:education_stewardship_3 = { $OPERATION$_trait_force_tooltip = education_stewardship_3 }
		flag:education_stewardship_4 = { $OPERATION$_trait_force_tooltip = education_stewardship_4 }
		flag:education_martial_1 = { $OPERATION$_trait_force_tooltip = education_martial_1 }
		flag:education_martial_2 = { $OPERATION$_trait_force_tooltip = education_martial_2 }
		flag:education_martial_3 = { $OPERATION$_trait_force_tooltip = education_martial_3 }
		flag:education_martial_4 = { $OPERATION$_trait_force_tooltip = education_martial_4 }
		flag:education_learning_1 = { $OPERATION$_trait_force_tooltip = education_learning_1 }
		flag:education_learning_2 = { $OPERATION$_trait_force_tooltip = education_learning_2 }
		flag:education_learning_3 = { $OPERATION$_trait_force_tooltip = education_learning_3 }
		flag:education_learning_4 = { $OPERATION$_trait_force_tooltip = education_learning_4 }
		flag:diplomat = { $OPERATION$_trait_force_tooltip = diplomat }
		flag:family_first = { $OPERATION$_trait_force_tooltip = family_first }
		flag:august = { $OPERATION$_trait_force_tooltip = august }
		flag:reveler_1 = { $OPERATION$_trait_force_tooltip = reveler_1 }
		flag:reveler_2 = { $OPERATION$_trait_force_tooltip = reveler_2 }
		flag:reveler_3 = { $OPERATION$_trait_force_tooltip = reveler_3 }
		flag:blademaster_1 = { $OPERATION$_trait_force_tooltip = blademaster_1 }
		flag:blademaster_2 = { $OPERATION$_trait_force_tooltip = blademaster_2 }
		flag:blademaster_3 = { $OPERATION$_trait_force_tooltip = blademaster_3 }
		flag:hunter_1 = { $OPERATION$_trait_force_tooltip = hunter_1 }
		flag:hunter_2 = { $OPERATION$_trait_force_tooltip = hunter_2 }
		flag:hunter_3 = { $OPERATION$_trait_force_tooltip = hunter_3 }
		flag:strategist = { $OPERATION$_trait_force_tooltip = strategist }
		flag:overseer = { $OPERATION$_trait_force_tooltip = overseer }
		flag:gallant = { $OPERATION$_trait_force_tooltip = gallant }
		flag:architect = { $OPERATION$_trait_force_tooltip = architect }
		flag:administrator = { $OPERATION$_trait_force_tooltip = administrator }
		flag:avaricious = { $OPERATION$_trait_force_tooltip = avaricious }
		flag:schemer = { $OPERATION$_trait_force_tooltip = schemer }
		flag:seducer = { $OPERATION$_trait_force_tooltip = seducer }
		flag:torturer = { $OPERATION$_trait_force_tooltip = torturer }
		flag:whole_of_body = { $OPERATION$_trait_force_tooltip = whole_of_body }
		flag:scholar = { $OPERATION$_trait_force_tooltip = scholar }
		flag:theologian = { $OPERATION$_trait_force_tooltip = theologian }
		flag:mystic_1 = { $OPERATION$_trait_force_tooltip = mystic_1 }
		flag:mystic_2 = { $OPERATION$_trait_force_tooltip = mystic_2 }
		flag:mystic_3 = { $OPERATION$_trait_force_tooltip = mystic_3 }
		flag:physician_1 = { $OPERATION$_trait_force_tooltip = physician_1 }
		flag:physician_2 = { $OPERATION$_trait_force_tooltip = physician_2 }
		flag:physician_3 = { $OPERATION$_trait_force_tooltip = physician_3 }
		flag:lifestyle_herbalist = { $OPERATION$_trait_force_tooltip = lifestyle_herbalist }
		flag:lustful = { $OPERATION$_trait_force_tooltip = lustful }
		flag:chaste = { $OPERATION$_trait_force_tooltip = chaste }
		flag:gluttonous = { $OPERATION$_trait_force_tooltip = gluttonous }
		flag:temperate = { $OPERATION$_trait_force_tooltip = temperate }
		flag:greedy = { $OPERATION$_trait_force_tooltip = greedy }
		flag:generous = { $OPERATION$_trait_force_tooltip = generous }
		flag:lazy = { $OPERATION$_trait_force_tooltip = lazy }
		flag:diligent = { $OPERATION$_trait_force_tooltip = diligent }
		flag:wrathful = { $OPERATION$_trait_force_tooltip = wrathful }
		flag:calm = { $OPERATION$_trait_force_tooltip = calm }
		flag:patient = { $OPERATION$_trait_force_tooltip = patient }
		flag:impatient = { $OPERATION$_trait_force_tooltip = impatient }
		flag:arrogant = { $OPERATION$_trait_force_tooltip = arrogant }
		flag:humble = { $OPERATION$_trait_force_tooltip = humble }
		flag:deceitful = { $OPERATION$_trait_force_tooltip = deceitful }
		flag:honest = { $OPERATION$_trait_force_tooltip = honest }
		flag:craven = { $OPERATION$_trait_force_tooltip = craven }
		flag:brave = { $OPERATION$_trait_force_tooltip = brave }
		flag:shy = { $OPERATION$_trait_force_tooltip = shy }
		flag:gregarious = { $OPERATION$_trait_force_tooltip = gregarious }
		flag:ambitious = { $OPERATION$_trait_force_tooltip = ambitious }
		flag:content = { $OPERATION$_trait_force_tooltip = content }
		flag:arbitrary = { $OPERATION$_trait_force_tooltip = arbitrary }
		flag:just = { $OPERATION$_trait_force_tooltip = just }
		flag:cynical = { $OPERATION$_trait_force_tooltip = cynical }
		flag:zealous = { $OPERATION$_trait_force_tooltip = zealous }
		flag:paranoid = { $OPERATION$_trait_force_tooltip = paranoid }
		flag:trusting = { $OPERATION$_trait_force_tooltip = trusting }
		flag:compassionate = { $OPERATION$_trait_force_tooltip = compassionate }
		flag:callous = { $OPERATION$_trait_force_tooltip = callous }
		flag:sadistic = { $OPERATION$_trait_force_tooltip = sadistic }
		flag:stubborn = { $OPERATION$_trait_force_tooltip = stubborn }
		flag:fickle = { $OPERATION$_trait_force_tooltip = fickle }
		flag:vengeful = { $OPERATION$_trait_force_tooltip = vengeful }
		flag:forgiving = { $OPERATION$_trait_force_tooltip = forgiving }
		flag:rowdy = { $OPERATION$_trait_force_tooltip = rowdy }
		flag:charming = { $OPERATION$_trait_force_tooltip = charming }
		flag:curious = { $OPERATION$_trait_force_tooltip = curious }
		flag:pensive = { $OPERATION$_trait_force_tooltip = pensive }
		flag:bossy = { $OPERATION$_trait_force_tooltip = bossy }
		flag:drunkard = { $OPERATION$_trait_force_tooltip = drunkard }
		flag:hashishiyah = { $OPERATION$_trait_force_tooltip = hashishiyah }
		flag:rakish = { $OPERATION$_trait_force_tooltip = rakish }
		flag:reclusive = { $OPERATION$_trait_force_tooltip = reclusive }
		flag:irritable = { $OPERATION$_trait_force_tooltip = irritable }
		flag:flagellant = { $OPERATION$_trait_force_tooltip = flagellant }
		flag:profligate = { $OPERATION$_trait_force_tooltip = profligate }
		flag:improvident = { $OPERATION$_trait_force_tooltip = improvident }
		flag:contrite = { $OPERATION$_trait_force_tooltip = contrite }
		flag:comfort_eater = { $OPERATION$_trait_force_tooltip = comfort_eater }
		flag:inappetetic = { $OPERATION$_trait_force_tooltip = inappetetic }
		flag:journaller = { $OPERATION$_trait_force_tooltip = journaller }
		flag:confider = { $OPERATION$_trait_force_tooltip = confider }
		flag:athletic = { $OPERATION$_trait_force_tooltip = athletic }
		flag:pregnant = { $OPERATION$_trait_force_tooltip = pregnant }
		flag:depressed_1 = { $OPERATION$_trait_force_tooltip = depressed_1 }
		flag:depressed_genetic = { $OPERATION$_trait_force_tooltip = depressed_genetic }
		flag:lunatic_1 = { $OPERATION$_trait_force_tooltip = lunatic_1 }
		flag:lunatic_genetic = { $OPERATION$_trait_force_tooltip = lunatic_genetic }
		flag:possessed_1 = { $OPERATION$_trait_force_tooltip = possessed_1 }
		flag:possessed_genetic = { $OPERATION$_trait_force_tooltip = possessed_genetic }
		flag:ill = { $OPERATION$_trait_force_tooltip = ill }
		flag:pneumonic = { $OPERATION$_trait_force_tooltip = pneumonic }
		flag:great_pox = { $OPERATION$_trait_force_tooltip = great_pox }
		flag:early_great_pox = { $OPERATION$_trait_force_tooltip = early_great_pox }
		flag:lovers_pox = { $OPERATION$_trait_force_tooltip = lovers_pox }
		flag:leper = { $OPERATION$_trait_force_tooltip = leper }
		flag:wounded_1 = { $OPERATION$_trait_force_tooltip = wounded_1 }
		flag:wounded_2 = { $OPERATION$_trait_force_tooltip = wounded_2 }
		flag:wounded_3 = { $OPERATION$_trait_force_tooltip = wounded_3 }
		flag:maimed = { $OPERATION$_trait_force_tooltip = maimed }
		flag:one_eyed = { $OPERATION$_trait_force_tooltip = one_eyed }
		flag:one_legged = { $OPERATION$_trait_force_tooltip = one_legged }
		flag:disfigured = { $OPERATION$_trait_force_tooltip = disfigured }
		flag:infirm = { $OPERATION$_trait_force_tooltip = infirm }
		flag:incapable = { $OPERATION$_trait_force_tooltip = incapable }
		flag:gout_ridden = { $OPERATION$_trait_force_tooltip = gout_ridden }
		flag:consumption = { $OPERATION$_trait_force_tooltip = consumption }
		flag:cancer = { $OPERATION$_trait_force_tooltip = cancer }
		flag:typhus = { $OPERATION$_trait_force_tooltip = typhus }
		flag:bubonic_plague = { $OPERATION$_trait_force_tooltip = bubonic_plague }
		flag:smallpox = { $OPERATION$_trait_force_tooltip = smallpox }
		flag:sickly = { $OPERATION$_trait_force_tooltip = sickly }
		flag:scarred = { $OPERATION$_trait_force_tooltip = scarred }
		flag:eunuch = { $OPERATION$_trait_force_tooltip = eunuch }
		flag:blind = { $OPERATION$_trait_force_tooltip = blind }
		flag:beauty_bad_1 = { $OPERATION$_trait_force_tooltip = beauty_bad_1 }
		flag:beauty_bad_2 = { $OPERATION$_trait_force_tooltip = beauty_bad_2 }
		flag:beauty_bad_3 = { $OPERATION$_trait_force_tooltip = beauty_bad_3 }
		flag:beauty_good_1 = { $OPERATION$_trait_force_tooltip = beauty_good_1 }
		flag:beauty_good_2 = { $OPERATION$_trait_force_tooltip = beauty_good_2 }
		flag:beauty_good_3 = { $OPERATION$_trait_force_tooltip = beauty_good_3 }
		flag:intellect_bad_1 = { $OPERATION$_trait_force_tooltip = intellect_bad_1 }
		flag:intellect_bad_2 = { $OPERATION$_trait_force_tooltip = intellect_bad_2 }
		flag:intellect_bad_3 = { $OPERATION$_trait_force_tooltip = intellect_bad_3 }
		flag:intellect_good_1 = { $OPERATION$_trait_force_tooltip = intellect_good_1 }
		flag:intellect_good_2 = { $OPERATION$_trait_force_tooltip = intellect_good_2 }
		flag:intellect_good_3 = { $OPERATION$_trait_force_tooltip = intellect_good_3 }
		flag:physique_bad_1 = { $OPERATION$_trait_force_tooltip = physique_bad_1 }
		flag:physique_bad_2 = { $OPERATION$_trait_force_tooltip = physique_bad_2 }
		flag:physique_bad_3 = { $OPERATION$_trait_force_tooltip = physique_bad_3 }
		flag:physique_good_1 = { $OPERATION$_trait_force_tooltip = physique_good_1 }
		flag:physique_good_2 = { $OPERATION$_trait_force_tooltip = physique_good_2 }
		flag:physique_good_3 = { $OPERATION$_trait_force_tooltip = physique_good_3 }
		flag:pure_blooded = { $OPERATION$_trait_force_tooltip = pure_blooded }
		flag:fecund = { $OPERATION$_trait_force_tooltip = fecund }
		flag:strong = { $OPERATION$_trait_force_tooltip = strong }
		flag:shrewd = { $OPERATION$_trait_force_tooltip = shrewd }
		flag:clubfooted = { $OPERATION$_trait_force_tooltip = clubfooted }
		flag:hunchbacked = { $OPERATION$_trait_force_tooltip = hunchbacked }
		flag:lisping = { $OPERATION$_trait_force_tooltip = lisping }
		flag:stuttering = { $OPERATION$_trait_force_tooltip = stuttering }
		flag:dwarf = { $OPERATION$_trait_force_tooltip = dwarf }
		flag:giant = { $OPERATION$_trait_force_tooltip = giant }
		flag:inbred = { $OPERATION$_trait_force_tooltip = inbred }
		flag:weak = { $OPERATION$_trait_force_tooltip = weak }
		flag:dull = { $OPERATION$_trait_force_tooltip = dull }
		flag:impotent = { $OPERATION$_trait_force_tooltip = impotent }
		flag:spindly = { $OPERATION$_trait_force_tooltip = spindly }
		flag:scaly = { $OPERATION$_trait_force_tooltip = scaly }
		flag:albino = { $OPERATION$_trait_force_tooltip = albino }
		flag:wheezing = { $OPERATION$_trait_force_tooltip = wheezing }
		flag:bleeder = { $OPERATION$_trait_force_tooltip = bleeder }
		flag:infertile = { $OPERATION$_trait_force_tooltip = infertile }
		flag:celibate = { $OPERATION$_trait_force_tooltip = celibate }
		flag:pilgrim = { $OPERATION$_trait_force_tooltip = pilgrim }
		flag:excommunicated = { $OPERATION$_trait_force_tooltip = excommunicated }
		flag:devoted = { $OPERATION$_trait_force_tooltip = devoted }
		flag:sayyid = { $OPERATION$_trait_force_tooltip = sayyid }
		flag:saoshyant = { $OPERATION$_trait_force_tooltip = saoshyant }
		flag:saoshyant_descendant = { $OPERATION$_trait_force_tooltip = saoshyant_descendant }
		flag:savior = { $OPERATION$_trait_force_tooltip = savior }
		flag:divine_blood = { $OPERATION$_trait_force_tooltip = divine_blood }
		flag:blood_of_prophet = { $OPERATION$_trait_force_tooltip = blood_of_prophet }
		flag:faith_warrior = { $OPERATION$_trait_force_tooltip = faith_warrior }
		flag:saint = { $OPERATION$_trait_force_tooltip = saint }
		flag:order_member = { $OPERATION$_trait_force_tooltip = order_member }
		flag:berserker = { $OPERATION$_trait_force_tooltip = berserker }
		flag:shieldmaiden = { $OPERATION$_trait_force_tooltip = shieldmaiden }
		flag:varangian = { $OPERATION$_trait_force_tooltip = varangian }
		flag:poet = { $OPERATION$_trait_force_tooltip = poet }
		flag:bastard = { $OPERATION$_trait_force_tooltip = bastard }
		flag:legitimized_bastard = { $OPERATION$_trait_force_tooltip = legitimized_bastard }
		flag:disputed_heritage = { $OPERATION$_trait_force_tooltip = disputed_heritage }
		flag:child_of_concubine_female = { $OPERATION$_trait_force_tooltip = child_of_concubine_female }
		flag:child_of_concubine_male = { $OPERATION$_trait_force_tooltip = child_of_concubine_male }
		flag:wild_oat = { $OPERATION$_trait_force_tooltip = wild_oat }
		flag:bastard_founder = { $OPERATION$_trait_force_tooltip = bastard_founder }
		flag:twin = { $OPERATION$_trait_force_tooltip = twin }
		flag:kinslayer_1 = { $OPERATION$_trait_force_tooltip = kinslayer_1 }
		flag:kinslayer_2 = { $OPERATION$_trait_force_tooltip = kinslayer_2 }
		flag:kinslayer_3 = { $OPERATION$_trait_force_tooltip = kinslayer_3 }
		flag:deviant = { $OPERATION$_trait_force_tooltip = deviant }
		flag:cannibal = { $OPERATION$_trait_force_tooltip = cannibal }
		flag:sodomite = { $OPERATION$_trait_force_tooltip = sodomite }
		flag:incestuous = { $OPERATION$_trait_force_tooltip = incestuous }
		flag:adulterer = { $OPERATION$_trait_force_tooltip = adulterer }
		flag:fornicator = { $OPERATION$_trait_force_tooltip = fornicator }
		flag:murderer = { $OPERATION$_trait_force_tooltip = murderer }
		flag:born_in_the_purple = { $OPERATION$_trait_force_tooltip = born_in_the_purple }
		flag:augustus = { $OPERATION$_trait_force_tooltip = augustus }
		flag:viking = { $OPERATION$_trait_force_tooltip = viking }
		flag:reincarnation = { $OPERATION$_trait_force_tooltip = reincarnation }
		flag:adventurer = { $OPERATION$_trait_force_tooltip = adventurer }
		flag:heresiarch = { $OPERATION$_trait_force_tooltip = heresiarch }
		flag:peasant_leader = { $OPERATION$_trait_force_tooltip = peasant_leader }
		flag:witch = { $OPERATION$_trait_force_tooltip = witch }
		flag:disinherited = { $OPERATION$_trait_force_tooltip = disinherited }
		flag:denounced = { $OPERATION$_trait_force_tooltip = denounced }
		flag:logistician = { $OPERATION$_trait_force_tooltip = logistician }
		flag:military_engineer = { $OPERATION$_trait_force_tooltip = military_engineer }
		flag:aggressive_attacker = { $OPERATION$_trait_force_tooltip = aggressive_attacker }
		flag:unyielding_defender = { $OPERATION$_trait_force_tooltip = unyielding_defender }
		flag:forder = { $OPERATION$_trait_force_tooltip = forder }
		flag:flexible_leader = { $OPERATION$_trait_force_tooltip = flexible_leader }
		flag:desert_warrior = { $OPERATION$_trait_force_tooltip = desert_warrior }
		flag:jungle_stalker = { $OPERATION$_trait_force_tooltip = jungle_stalker }
		flag:reaver = { $OPERATION$_trait_force_tooltip = reaver }
		flag:reckless = { $OPERATION$_trait_force_tooltip = reckless }
		flag:holy_warrior = { $OPERATION$_trait_force_tooltip = holy_warrior }
		flag:open_terrain_expert = { $OPERATION$_trait_force_tooltip = open_terrain_expert }
		flag:rough_terrain_expert = { $OPERATION$_trait_force_tooltip = rough_terrain_expert }
		flag:forest_fighter = { $OPERATION$_trait_force_tooltip = forest_fighter }
		flag:cautious_leader = { $OPERATION$_trait_force_tooltip = cautious_leader }
		flag:organizer = { $OPERATION$_trait_force_tooltip = organizer }
		flag:winter_soldier = { $OPERATION$_trait_force_tooltip = winter_soldier }
		flag:crusader_king = { $OPERATION$_trait_force_tooltip = crusader_king }
		flag:chakravarti = { $OPERATION$_trait_force_tooltip = chakravarti }
		flag:greatest_of_khans = { $OPERATION$_trait_force_tooltip = greatest_of_khans }
		flag:paragon = { $OPERATION$_trait_force_tooltip = paragon }
		flag:consecrated_blood = { $OPERATION$_trait_force_tooltip = consecrated_blood }
		flag:education_martial_prowess_1 = { $OPERATION$_trait_force_tooltip = education_martial_prowess_1 }
		flag:education_martial_prowess_2 = { $OPERATION$_trait_force_tooltip = education_martial_prowess_2 }
		flag:education_martial_prowess_3 = { $OPERATION$_trait_force_tooltip = education_martial_prowess_3 }
		flag:education_martial_prowess_4 = { $OPERATION$_trait_force_tooltip = education_martial_prowess_4 }
		flag:beauty_good_4 = { $OPERATION$_trait_force_tooltip = beauty_good_4 }
		flag:beauty_good_5 = { $OPERATION$_trait_force_tooltip = beauty_good_5 }
		flag:beauty_bad_4 = { $OPERATION$_trait_force_tooltip = beauty_bad_4 }
		flag:beauty_bad_5 = { $OPERATION$_trait_force_tooltip = beauty_bad_5 }
		flag:physique_good_4 = { $OPERATION$_trait_force_tooltip = physique_good_4 }
		flag:physique_good_5 = { $OPERATION$_trait_force_tooltip = physique_good_5 }
		flag:physique_bad_4 = { $OPERATION$_trait_force_tooltip = physique_bad_4 }
		flag:physique_bad_5 = { $OPERATION$_trait_force_tooltip = physique_bad_5 }
		flag:intellect_good_4 = { $OPERATION$_trait_force_tooltip = intellect_good_4 }
		flag:intellect_good_5 = { $OPERATION$_trait_force_tooltip = intellect_good_5 }
		flag:intellect_bad_4 = { $OPERATION$_trait_force_tooltip = intellect_bad_4 }
		flag:intellect_bad_5 = { $OPERATION$_trait_force_tooltip = intellect_bad_5 }
		flag:surefooted = { $OPERATION$_trait_force_tooltip = surefooted }
		flag:regal_bearing = { $OPERATION$_trait_force_tooltip = regal_bearing }
		flag:glowing = { $OPERATION$_trait_force_tooltip = glowing }
		flag:hardy_lung = { $OPERATION$_trait_force_tooltip = hardy_lung }
		flag:pt_balanced_humors = { $OPERATION$_trait_force_tooltip = pt_balanced_humors }
		flag:paragon = { $OPERATION$_trait_force_tooltip = paragon }
		flag:nearsighted = { $OPERATION$_trait_force_tooltip = nearsighted }
		flag:hawkeyed = { $OPERATION$_trait_force_tooltip = hawkeyed }
		flag:deaf = { $OPERATION$_trait_force_tooltip = deaf }
		flag:keen-eared = { $OPERATION$_trait_force_tooltip = keen-eared }
		flag:permanent_scowl = { $OPERATION$_trait_force_tooltip = permanent_scowl }
		flag:friendly_face = { $OPERATION$_trait_force_tooltip = friendly_face }
		flag:paragon = { $OPERATION$_trait_force_tooltip = paragon }
		flag:silver_tongued = { $OPERATION$_trait_force_tooltip = silver_tongued }
		flag:dyslexic = { $OPERATION$_trait_force_tooltip = dyslexic }
		flag:hyperlexic = { $OPERATION$_trait_force_tooltip = hyperlexic }
		flag:dyscalculic = { $OPERATION$_trait_force_tooltip = dyscalculic }
		flag:hypercalculic = { $OPERATION$_trait_force_tooltip = hypercalculic }
	}
}

set_post_spell_actor = {
	if = {
		limit = {
			OR = {
				NOT = { has_global_variable_list = post_spell_actors }
				NOT = { any_in_list = { variable = post_spell_actors count > 0 number_of_traits = 0 } }
			}
		}
		create_post_spell_actor = yes
	}
	random_in_global_list = {
		variable = post_spell_actors
		limit = { number_of_traits = 0 }
		save_temporary_scope_as = post_spell_actor
	}
	set_variable = { name = post_spell_actor value = scope:post_spell_actor }
	var:post_spell_actor = { copy_traits = root.scope:recipient }
}

create_post_spell_actor = {
	create_character = {
		age = 18
		gender = root
		random_traits = no
		health = 
		fertility = 
		location = root.capital_province
		faith = root.faith
		culture = root.culture
		dynasty = none
		martial = 0
		diplomacy = 0
		intrigue = 0
		stewardship = 0
		learning = 0
		after_creation = {
			make_unprunable = yes
			death = natural
			clear_traits = yes
			add_to_global_variable_list = {
				name = post_spell_actors
				value = this
			}
		}
	}
}

unset_post_spell_actor = {
	var:post_spell_actor = { clear_traits = yes }
	remove_variable = post_spell_actor
}
