on_game_start = {
	on_actions = {
		set_up_spells
	}
}

set_up_spells = {
	effect = {
		set_up_spells = yes
	}
}


on_death = {
	on_actions = {
		reset_slowness_drain
		reset_mass_slowness_drain
		reset_master_of_time_drain
	}
}

reset_slowness_drain = {
	trigger = {
		has_character_modifier = slowness_modifier
	}

	effect = {
		every_living_character = {
			limit = {
				AND = {
					has_variable = slowness_target
					var:slowness_target = prev
				}
			}
			remove_variable = slowness_target
			trigger_event = { on_action = on_reset_mana_system }
		}
	}
}

reset_mass_slowness_drain = {
	trigger = {
		has_character_modifier = mass_slowness_modifier
	}

	effect = {
		every_living_character = {
			limit = {
				AND = {
					has_variable = mass_slowness_target
					var:mass_slowness_target = prev
				}
			}
			remove_variable = mass_slowness_target
			trigger_event = { on_action = on_reset_mana_system }
		}
	}
}

# immortals can still die from murder effects
reset_master_of_time_drain = {
	trigger = {
		has_trait = immortal
	}

	effect = {
		every_living_character = {
			limit = {
				has_variable_list = master_of_time_spell_targets
				is_target_in_variable_list = { name = master_of_time_spell_targets target = prev }
			}
			remove_list_variable = { name = master_of_time_spell_targets target = prev }
			trigger_event = { on_action = on_reset_mana_system }
		}
	}
}
