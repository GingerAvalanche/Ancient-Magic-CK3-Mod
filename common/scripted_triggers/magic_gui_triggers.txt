trigger_magic_is_aura = {
	switch = {
		trigger = $SPELL$
		flag:glimpse_the_future_spell = { always = yes }
		flag:financial_times_spell = { always = yes }
		flag:celerity_spell = { always = yes }
		flag:mass_celerity_spell = { always = yes }
		flag:slowness_spell = { always = yes }
		flag:mass_slowness_spell = { always = yes }
		flag:temporal_manipulation_spell = { always = yes }
		flag:flame_aura_spell = { always = yes }
		flag:flaming_weapons_spell = { always = yes }
		flag:living_earthworks_spell = { always = yes }
		flag:control_water_spell = { always = yes }
		flag:drought_spell = { always = yes }
		flag:elemental_warrior_spell = { always = yes }
		flag:aura_of_death_spell = { always = yes }
		flag:fertility_control_spell = { always = yes }
		flag:beguiling_aura_spell = { always = yes }
		flag:enchanting_aura_spell = { always = yes }
		fallback = { always = no }
	}
}

trigger_is_adding_personality_trait = {
	switch = {
		trigger = $FLAG$
		flag:lustful = { NOT = { has_trait = lustful } }
		flag:chaste = { NOT = { has_trait = chaste } }
		flag:gluttonous = { NOT = { has_trait = gluttonous } }
		flag:temperate = { NOT = { has_trait = temperate } }
		flag:greedy = { NOT = { has_trait = greedy } }
		flag:generous = { NOT = { has_trait = generous } }
		flag:lazy = { NOT = { has_trait = lazy } }
		flag:diligent = { NOT = { has_trait = diligent } }
		flag:wrathful = { NOT = { has_trait = wrathful } }
		flag:calm = { NOT = { has_trait = calm } }
		flag:impatient = { NOT = { has_trait = impatient } }
		flag:patient = { NOT = { has_trait = patient } }
		flag:arrogant = { NOT = { has_trait = arrogant } }
		flag:humble = { NOT = { has_trait = humble } }
		flag:deceitful = { NOT = { has_trait = deceitful } }
		flag:honest = { NOT = { has_trait = honest } }
		flag:craven = { NOT = { has_trait = craven } }
		flag:brave = { NOT = { has_trait = brave } }
		flag:shy = { NOT = { has_trait = shy } }
		flag:gregarious = { NOT = { has_trait = gregarious } }
		flag:ambitious = { NOT = { has_trait = ambitious } }
		flag:content = { NOT = { has_trait = content } }
		flag:arbitrary = { NOT = { has_trait = arbitrary } }
		flag:just = { NOT = { has_trait = just } }
		flag:cynical = { NOT = { has_trait = cynical } }
		flag:zealous = { NOT = { has_trait = zealous } }
		flag:paranoid = { NOT = { has_trait = paranoid } }
		flag:trusting = { NOT = { has_trait = trusting } }
		flag:callous = { NOT = { has_trait = callous } }
		flag:compassionate = { NOT = { has_trait = compassionate } }
		flag:vengeful = { NOT = { has_trait = vengeful } }
		flag:forgiving = { NOT = { has_trait = forgiving } }
		flag:fickle = { NOT = { has_trait = fickle } }
		flag:stubborn = { NOT = { has_trait = stubborn } }
		flag:sadistic = { NOT = { has_trait = sadistic } }
		fallback = { always = no }
	}
}

rewrite_trait_list_good_3_trigger = {
	OR = {
		AND = {
			has_perk = perfect_trait_perk
			scope:spell_target = {
				has_trait_rank = { trait = $TRAIT_TYPE$_good rank > 1 }
				NOT = { has_trait_rank = { trait = $TRAIT_TYPE$_good rank = $RANK$ } }
			}
		}
		AND = {
			has_perk = perfect_trait_perk
			has_perk = improve_trait_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_good rank = 1 } }
		}
		AND = {
			has_perk = perfect_trait_perk
			has_perk = improve_trait_perk
			has_perk = architect_of_bloodlines_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_good rank < 1 } }
		}
	}
}

rewrite_trait_list_good_2_trigger = {
	OR = {
		AND = {
			has_perk = weaken_trait_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_good rank > 2 } }
		}
		AND = {
			has_perk = improve_trait_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_good rank = 1 } }
		}
		AND = {
			has_perk = improve_trait_perk
			has_perk = architect_of_bloodlines_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_good rank < 1 } }
		}
	}
}

rewrite_trait_list_good_1_trigger = {
	OR = {
		AND = {
			has_perk = weaken_trait_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_good rank > 1 } }
		}
		AND = {
			has_perk = architect_of_bloodlines_perk
			scope:spell_target = {
				has_trait_rank = { trait = $TRAIT_TYPE$_good rank < 1 }
				has_trait_rank = { trait = $TRAIT_TYPE$_bad rank < 1 }
			}
		}
		AND = {
			has_perk = improve_trait_perk
			has_perk = architect_of_bloodlines_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_bad rank > 0 } }
		}
	}
}

rewrite_trait_list_none_trigger = {
	OR = {
		AND = {
			has_perk = weaken_trait_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_good rank > 0 } }
		}
		AND = {
			has_perk = improve_trait_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_bad rank > 0 } }
		}
	}
}

rewrite_trait_list_bad_1_trigger = {
	OR = {
		AND = {
			has_perk = weaken_trait_perk
			has_perk = architect_of_bloodlines_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_good rank > 0 } }
		}
		AND = {
			has_perk = architect_of_bloodlines_perk
			scope:spell_target = {
				has_trait_rank = { trait = $TRAIT_TYPE$_good rank < 1 }
				has_trait_rank = { trait = $TRAIT_TYPE$_bad rank < 1 }
			}
		}
		AND = {
			has_perk = improve_trait_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_bad rank > 1 } }
		}
	}
}

rewrite_trait_list_bad_2_trigger = {
	OR = {
		AND = {
			has_perk = weaken_trait_perk
			has_perk = architect_of_bloodlines_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_bad rank < 1 } }
		}
		AND = {
			has_perk = weaken_trait_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_bad rank = 1 } }
		}
		AND = {
			has_perk = improve_trait_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_bad rank > 2 } }
		}
	}
}

rewrite_trait_list_bad_3_trigger = {
	OR = {
		AND = {
			has_perk = architect_of_bloodlines_perk
			has_perk = weaken_trait_perk
			has_perk = criple_trait_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_bad rank < 1 } }
		}
		AND = {
			has_perk = weaken_trait_perk
			has_perk = criple_trait_perk
			scope:spell_target = { has_trait_rank = { trait = $TRAIT_TYPE$_bad rank = 1 } }
		}
		AND = {
			has_perk = criple_trait_perk
			scope:spell_target = {
				has_trait_rank = { trait = $TRAIT_TYPE$_bad rank > 1 }
				NOT = { has_trait_rank = { trait = $TRAIT_TYPE$_bad rank = $RANK$ } }
			}
		}
	}
}
